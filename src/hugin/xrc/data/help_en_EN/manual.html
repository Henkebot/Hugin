<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>hugin Manual</title>
<!--#include virtual="/ssi/css.html"-->
</head>
<body>

<!--#include virtual="/ssi/menu.html"-->
<div class="content">
<h1>hugin Manual</h1>

<p>A easy to use GUI for <a href="http://www.path.unimelb.edu.au/~dersch/">Panorama Tools</a>.</p>

<p>Hugin currently supports most features of panorama tools, and can be
used for to create different kinds of panoramic images.</p>

<h2>Introduction</h2>

<p> This is the reference manual (hah, good joke... :-) for hugin. It
does not cover general panorama creation, but tries to document
keyboard shortcuts and other things that are not obvious from the first
look at the interface.  </p>

<p>
  The <a href="http://hugin.sf.net">hugin homepage</a> contains more
  general information and even some tutorials.
</p>

<h2>Credits</h2>
<ul>
<li>Main programming:Pablo d'Angelo &lt;pablo&#64;mathematik.uni-ulm.de&gt;</li>
<li>Additional programming: Kai-Uwe Behrmann</li>
<li>Tutorials and rpm packages: Bruno Postle</li>
</ul>

<p>Thanks to all people on the ptx mailing list, for many interesting
ideas and for testing.</p>

<h2><a name="MW">Main Window</a></h2>

<p> This window consists of a toolbar that provides quick access to
important functions. It also contains the Images, Lens, Control Point,
Optimizer and Panorama Tab, which will be explained below.</p>

<h3><a name="MWImages">Images Tab</a></h3>

<p>The images tab is used to manage the images in the project.
Additionally the positions of the images in the final panorama can be
edited here.</p>

<h4>Adding images</h4>

<p> Images can either be added with the <b>Add</b> and <b>Add time
    series</b> button or via drag and drop. <b>Add time series</b>
prompts adds all images with a similar file modification time as the
selected image.
</p>

<p>Reference images can be set for position of the image in the
panorama and color/brightness compensation (currently only supported by
PTStitcher). The <b>Adjust the anchor spot</b> opens a new window
where the position of the horizon in the anchor image can be set with
the left mouse button and rotated with the right mouse button. This
dialog is currently a bit buggy and the rotation behaviour is
inconsistent (the horizon is aways rotated around the image center).
If possible, vertical (and sometime horizontal) control points should
be used to archive a straight horizon in the panorama. See the
<a
    href="http://hugin.sf.net/tutorials">http://hugin.sf.net/tutorials</a>
for more information on this topic.
</p>

<p>Automatic creation of control points can be done by selecting the
images between those control points should be found and pressing the
<b>Create Ctrl Points</b> button. hugin will then launch autopano or
Autopano-SIFT and add the detected control points to the
project. The <a href="#pref_panel">Preferences</a> is used to select
which program should be used, and set further options <b>Remove Points</b>
does exactly what its name suggests, it removes control points between
the selected images, or all control points if no image is selected.
</p>

<p>
In the <b>Image Orientation</b> section, the position of the selected
images in
the final panorama can be specified by yaw, pitch and roll angle (in
degrees).

<!-- TODO: add description of yaw, pitch and roll angle --> 

The <b>Reset</b> button will reset all angles to zero. This is useful
if the optimizer could not determine the image orientation well and
got stuck with a suboptimal result. It is possible to select multiple
images at the same time. Changes in orientation will be applied to all
selected images
</p>

<h3><a name="MWLens">Camera and Lens Tab</a></h3>
<p>
  The lens tab looks a lot like the Images tab, except that the lens settings
  can be edited here. As in the Images Tab, multiselection can be used
  to change the parameters for multiple images.
</p>

<p> Panorama Tools and hugin allow the usage of images shot with
different lenses and settings inside the same project. Each image is
associated with a lens number. All images that share the same lens
number use the same lens type, and may be forced to share the same
lens parameters.
</p>

<p>
The most important parameters are the <b>Lens type</b> and the
<b>hor. field of view</b>. hugin support the following projections in
input images:
<ul>
    <li><b>rectilinear</b> This is the projection used by most
    cameras. It keeps straight lines straight. The maximum horizontal
    field of view is 180 degrees (for an image of infinite size, that
    is).
    </li>
    <li><b>Panoramic</b> is used by panoramic cameras, such as the
    Horizon, Roundshot and Spheron cameras. This projection is also
    called cylindrical projection.
    </li>
    <li><b>Circular fisheye</b> This is projection is used by fisheye
    lenses. If the image is circular, or the corners of the image are
    black, use this type of fisheye lens. A circular crop (see
    <a href=#crop">Cropping</a> can be used for cutting away the edge
    borders.
    </li>
    <li><b>Full frame fisheye</b> Exactly the same projection as
    above, but the crop option will crop to an rectangle instead of a
    circle. This should be used for full frame fisheye images.
    </li>
</ul>
</p>

<p>
After the lens type has been specified, an estimate for the horizontal
field of view (HFOV) is required. The HFOV specifies the horizontal
opening angle of the image in degrees. Since most photographers are
more familar with focal length as a measure for the HFOV, it can be
entered into hugin, and hugin will compute the HFOV from it. For this
calculation the actual focal length and the crop factor of the camera
are required. If the 35mm film equivalent focal length is known, a
crop factor of 1 should be used.
</p>

<p>
In case of jpeg images, hugin can usually automatically calculate the
HFOV based on the EXIF information.
</p>

<p> Usually lenses do not project images exactly according to the
selected projection type, but suffer from distortions. In many cases
the distortions are acceptable for single image shots, but they need
to be corrected when stitching a panorama. The <b>a</b>,<b>b</b> and
<b>c</b> parameters are used to remove that distortion. They are
applied radially from the image center, which can be moved by changing
the <b>d</b> and <b>e</b> parameters. <b>TODO: link to distortion
    model</b>
</p>

<p>
Scanned images might also suffer from image shearing. This can be
corrected using the <b>g</b> and <b>t</b> parameters.
</p>

<p>
The distortion parameters usually vary with the focal length, and to a
lesser degree with the focus. The <b>link</b> checkbox indicates
wether the parameter is linked or not. A linked parameter is forced to
the same value for all images with the same lens number. This is
the default for the HFOV and distortion parameters. If a parameter is
not linked each images is allowed to have individual values for the
respective parameter. This is useful if a different zoom or focus
setting has been used for some images. If scanned images are used,
they are usually not perfectly centered, and each image should have
individual d and e parameters.
</p>
<p>
The photometric corrections include vignetting correction and
color/brightness adjustment. <b>TODO: document</b>
</p>

<h3><a name="MWControlPoints">Control Point Tab</a></h3>

<p>

Control points a central to Panorama Tools and hugin, because they
are used to estimate the position of image position and lens
parameters described above. A control point specifies  a corresponding
point between two images. Using these corresponding points, the
optimizer can estimate the image position and lens parameters. It is
therefore important that the control points are accurate and usually
at least 3 well distributed control points should be used to estimate the image
position (yaw, roll and pitch) and maybe the HFOV. For accurate
estimation of the a,b,c distortion parameters, many well distributed
control points, and a large overlap (up to 50%) are required.

</p>

<p>
  The Tab consists of two image displays and tab bars to switch images
  to be editied. The bottom contains a list view where Points can be
  selected and some fields to edit a selected point. Points can also
  be selected by clicking or dragging on them in the images. It is
  possible to zoom out to show the full image.
</p>

<p>
Adding a control point works by selecting one point in the left or
right image, and then clicking onto the corresponding point in the
other image.  If <b>auto add</b> is not set, the points can be moved
by clicking at some other place in the images.  They are added to the
list of control points by pressing the <b>right mouse button</b>, the
"a" key or by pushing the <b>Add</b> button or by pushing the
<b>Add</b> button.  If you press the right mouse button when only one
point is slected, the point selection will be aborted. <b>auto add</b>
adds the control point as soon as both points have been specified.
</p>

<p> If the images are zoomed out (fit to window), the first click
zooms to a temporary 100% view to give you the chance to refine your
selection. Note that only the second click will trigger the auto
estimate.</p>

<p>
Often it is hard to select the corresponding point exactly. However,
the control points should be as accurate as possible, for good
results. Once a point pair has been roughly selected, the <b>fine
tune</b> function of hugin can be used to estimate the corresponding
point up to one tenth of a pixel.
The keyboard shortcut for the fine tune function is the <b>f</b> key.
Fine tune only search in a small neighbourhood of the currently
selected points. The size of this neighbourhood can be controlled by
opening the preferences panel and setting the "Local area search
width".
</p>

<p>
Note that the fune tune function estimates the translation of the
patch around the point selected in the other image with respect to the
current image. This works well if the rotation between the images is
small and narrow angle lenses have been used. If wide angle or fisheye
images are used, rotation search should be activated in the
preferences panel. Then hugin also searches for rotated occurences of
the patch around the selected point.
</p>

<p>
The image can be scrolled by pressing the <b>middle mouse button</b>
or the <b>CTRL key</b> while moving the mouse. If the <b>shift key</b>
is pressed instead, both images will be scrolled. This is very
useful, if control points are set using the 100% zoom level.
</p>

<p>
  Control point creation is also influenced by the following checkboxes:
  <ul>
    <li> <b>auto fine tune</b> hugin helps you to find the second point
      by looking for it in a search region (shown by a rectange around
      the cursor). This might not always work, but usually is reliable,
      if the image distortions are not too big. Try and play with it.
    </li>
    <li> <b>auto add</b> A control point is automatically added when both
      points are know. You won't have time to refine the selection
      before adding the point.
    </li>
    <li> <b>auto estimate</b> Tries to estimate the position of the
      second point by estimating the translation between the two images.
      This is very crude and probably only works for single row panoramas
      created from rectilinear images.
    </li>
  </ul>
</p>

<p>
  All these flags can be combined. I typically use <b>auto fine tune</b> and
  <b>auto estimate</b> at the same time. Then hugin usually
  automatically selects the second point correctly, at least for
  normal, rectilinear images that are not rotated too much.
</p>

<p>
hugin also includes an experimental control point creation algorithm.
It can be invoked by pressing the "g" key.

Corners in the currently selected image are detected, and
corresponding control points are set, based on the 

<p>
 Here is a summary of the keyboard shortcuts available in the Control
 Point tab:
</p>

  <table summary="">
    <tr> <th> Key </th> <th> Function </th> </tr>
    <tr> <td> a </td> <td> add a new point that has been selected in both images, and the <b>auto add</b> is switched off. </td> </tr>
    <tr> <td> cursor keys </td> <td> scroll image under the mouse cursor </td> </tr>
    <tr> <td> shift + cursor keys </td> <td> scroll both images at the same time </td> </tr>
    <tr> <td> f </td> <td> fine tune currently selected control point pair. Same as the <b>Fine Tune</b> button </td> </tr>
    <tr> <td> g </td> <td> experimental control point generation
            algorithm.
    <tr> <td> Del </td> <td> Remove currently selected control point. </td> </tr>
    <tr> <td> 0 </td> <td> Zoom out to full view. </td> </tr>
    <tr> <td> 1 </td> <td> 100% view. </td> </tr>
  </table>

  <table summary="">
    <tr> <th> Mouse function </th> <th> Function </th> </tr>
    <tr>
      <td> control key + mouse movement </td>
      <td> Scroll image under cursor </td>
    </tr>
    <tr>
      <td> shift key + mouse movement </td>
      <td> Scroll both images </td>
    </tr>
    <tr>
      <td> left button </td>
      <td> Use left mouse button to select new points or drag existing
        points.
      </td>
    </tr>
    <tr>
      <td> right mouse button </td>
      <td> Add control point, if <b>auto add</b> is switched off </td>
    </tr>
    <tr>
      <td> middle mouse button </td>
      <td> Scroll image under cursor </td>
    </tr>
    <tr>
      <td> shift + middle mouse button </td>
      <td> Scroll both images </td>
    </tr>
  </table>


<h3>Optimizer Tab</h3>
<p>
  The optimizer moves the images into the right position, so that they
  can be assembled into a hopefully seamless panorama.
</p>

<p>
  To select what the optimiser should try to estimate, use the <b>Optimize</b>
  combo box, then click the <b>Optimize</b> Button.

  If you select the "custom" setting, you can change
</p>

<h3>Pano Panel</h3>
<p>
Options concerning the output panorama can be set here.
FIXME, write some more...
</p>

<hr/>
<p>
This document was written by Pablo d'Angelo <a href="mailto:pablo.dangelo&#64;web.de">&lt;pablo.dangelo&#64;web.de&gt;</a>
</p>

<!--#include virtual="/ssi/homelink.html"-->

</div>
</body>
</html>
